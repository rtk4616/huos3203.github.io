{"title":"ngrok使用","slug":"工具/ngrok使用","date":"2017-09-06T12:23:24.000Z","updated":"2017-10-02T22:00:43.000Z","comments":true,"path":"api/articles/工具/ngrok使用.json","excerpt":null,"covers":["http://p27uwfdhv.bkt.clouddn.com/static/images/tcp协议SSH端口22.png?imageMogr2/2/w/800","http://p27uwfdhv.bkt.clouddn.com/static/images/ssh工具配置.jpg?imageMogr2/2/w/800","http://p27uwfdhv.bkt.clouddn.com/static/images/网络实用工具.png?imageMogr2/2/w/800","http://p27uwfdhv.bkt.clouddn.com/static/images/SSH连接成功.jpg?imageMogr2/2/w/800","http://tonybai.com/wp-content/uploads/ngrok-tunnel.png"],"content":"<script src=\"/assets/js/APlayer.min.js\"> </script><h3 id=\"注册\"><a href=\"#注册\" class=\"headerlink\" title=\"注册\"></a>注册</h3><p>1.注册<a href=\"https://ngrok.com/signup\" target=\"_blank\" rel=\"noopener\">https://ngrok.com/signup</a></p>\n<ol>\n<li>Start by <a href=\"https://ngrok.com/download\" target=\"_blank\" rel=\"noopener\">downloading ngrok</a>.</li>\n<li><p>Install your authtoken</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./ngrok authtoken 2tpoyojTzL5w55Y4na5DY_3shJgaMVzjJ*****</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Create your first secure tunnel</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./ngrok http 80</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Open the web interface at <a href=\"http://localhost:4040\" target=\"_blank\" rel=\"noopener\">http://localhost:4040</a> to inspect and replay requests</p>\n</li>\n<li>Read the documentation for instructions on advanced features like adding HTTP authentication, setting custom subdomains and more.<h3 id=\"开启TCP协议\"><a href=\"#开启TCP协议\" class=\"headerlink\" title=\"开启TCP协议\"></a>开启TCP协议</h3></li>\n<li>开启TCP实现SSH远程访问. <a href=\"https://ngrok.com/docs#tcp\" target=\"_blank\" rel=\"noopener\">详见</a><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./ngrok tcp 22</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<p>如图：<br><img src=\"http://p27uwfdhv.bkt.clouddn.com/static/images/tcp协议SSH端口22.png?imageMogr2/2/w/800\"></p>\n<blockquote>\n<p>每当执行开启命令，端口就会随机生成最新的。</p>\n</blockquote>\n<ol>\n<li>配置SSH远程工具<br>自定义SSH名：ngrok<br>SSH域名地址：0.tcp.ngrok.io  (ngrok提供的免费域名，IP地址ping就变新)<br>SSH端口号：16335 （每次重新启动时需更新）<br>用户名称/密码: 电脑管理员账户/密码<img src=\"http://p27uwfdhv.bkt.clouddn.com/static/images/ssh工具配置.jpg?imageMogr2/2/w/800\"></li>\n<li>手机热点访问远程内网电脑<br>连接前准备：<ol>\n<li>使用“网络实用工具”扫描<code>0.tcp.ngrok.io</code>域名，确保当前网络16335端口开启</li>\n<li>备选方案，使用手机热点分享，来访问内网电脑，进行连通测试。<img src=\"http://p27uwfdhv.bkt.clouddn.com/static/images/网络实用工具.png?imageMogr2/2/w/800\"></li>\n</ol>\n</li>\n<li>连接成功。<img src=\"http://p27uwfdhv.bkt.clouddn.com/static/images/SSH连接成功.jpg?imageMogr2/2/w/800\">\n总结：可以使用ngrok客户端，开启tcp协议端口，实现SSH远程控制，在不要求过高的网速和安全，可以不搭建ngrok服务器。</li>\n</ol>\n<h3 id=\"强大的tunnel-隧道-工具部署原理\"><a href=\"#强大的tunnel-隧道-工具部署原理\" class=\"headerlink\" title=\"强大的tunnel(隧道)工具部署原理\"></a>强大的tunnel(隧道)工具部署原理</h3><p><a href=\"http://tonybai.com/2015/05/14/ngrok-source-intro/\" target=\"_blank\" rel=\"noopener\">部署</a><br>ngrok在其github官方页面上的自我诠释是 “introspected tunnels to localhost”，这个诠释有两层含义：<br>1、可以用来建立public到localhost的tunnel，让居于内网主机上的服务可以暴露给public，俗称内网穿透。<br>2、支持对隧道中数据的introspection（内省），支持可视化的观察隧道内数据，并replay（重放）相关请求（诸如http请 求）。<br>因此ngrok可以很便捷的协助进行服务端程序调试，尤其在进行一些Web server开发中。ngrok更强大的一点是它支持tcp层之上的所有应用协议或者说与应用层协议无关。比如：你可以通过ngrok实现ssh登录到内 网主 机，也可以通过ngrok实现远程桌面(VNC)方式访问内网主机。</p>\n<p>一、ngrok tunnel与ngrok部署</p>\n<p>网络tunnel（隧道）对多数人都是很”神秘“的概念，tunnel种类很多，没有标准定义，我了解的也不多（日常工作较少涉及），这里也就不 深入了。在《HTTP权威指南》中有关于HTTP tunnel（http上承载非web流量）和SSL tunnel的说明，但ngrok中的tunnel又与这些有所不同。</p>\n<p>ngrok实现了一个tcp之上的端到端的tunnel，两端的程序在ngrok实现的Tunnel内透明的进行数据交互。<br><img src=\"http://tonybai.com/wp-content/uploads/ngrok-tunnel.png\" alt=\"\"><br>ngrok分为client端(ngrok)和服务端(ngrokd)，实际使用中的部署如下：<br><img src=\"http://tonybai.com/wp-content/uploads/ngrok-deployment.png\" alt=\"\"><br>内网服务程序可以与ngrok client部署在同一主机，也可以部署在内网可达的其他主机上。ngrok和ngrokd会为建立与public client间的专用通道（tunnel）。</p>\n","categories":[{"name":"工具","path":"api/categories/工具.json"},{"name":"网络","path":"api/categories/网络.json"}],"tags":[]}