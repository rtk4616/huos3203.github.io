{"name":"shell","postlist":[{"title":"终端实现预览plantuml的插件","slug":"shell/终端实现预览plantuml的插件","date":"2018-05-29T11:32:04.000Z","updated":"2018-06-01T10:07:54.000Z","comments":true,"path":"api/articles/shell/终端实现预览plantuml的插件.json","excerpt":null,"keywords":null,"cover":"http://p27uwfdhv.bkt.clouddn.com/static/images/plantumlpreviewer.png?imageMogr2/2/w/800","content":"<link rel=\"stylesheet\" href=\"/owl.css\"><link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><div id=\"badge-container-weirongxu-plantuml-previewer.vim-bf4b3e5\" class=\"hexo-github\" style=\"width: =\"></div>\n<script src=\"/hexo-github/badge.js\"></script>\n<script type=\"text/javascript\">\n  loadStyle(\"/hexo-github/style.css\");\n  loadStyle(\"/hexo-github/octicons/octicons.css\");\n  new Badge(\"#badge-container-weirongxu-plantuml-previewer.vim-bf4b3e5\", \"weirongxu\", \"plantuml-previewer.vim\", \"bf4b3e5\", false);\n</script>\n\n<h2 id=\"安装依赖\"><a href=\"#安装依赖\" class=\"headerlink\" title=\"安装依赖\"></a>安装依赖</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Plug <span class=\"string\">'huos3203/plantuml-syntax'</span>  <span class=\"string\">\"plantuml语法高亮 Plug 'aklt/plantuml-syntax'</span></span><br><span class=\"line\"><span class=\"string\">Plug 'tyru/open-browser.vim'</span></span><br><span class=\"line\"><span class=\"string\">Plug 'weirongxu/plantuml-previewer.vim' \"</span>在线工具：http://sujoyu.github.io/plantuml-previewer/</span><br></pre></td></tr></table></figure>\n<h3 id=\"Graphviz\"><a href=\"#Graphviz\" class=\"headerlink\" title=\"Graphviz\"></a>Graphviz</h3><p><a href=\"https://www.graphviz.org/download/\" target=\"_blank\" rel=\"noopener\">下载地址</a><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">brew install graphviz</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"打开浏览器safari插件工具\"><a href=\"#打开浏览器safari插件工具\" class=\"headerlink\" title=\"打开浏览器safari插件工具\"></a>打开浏览器safari插件工具</h3><p>open-browser.vim</p>\n<h3 id=\"语法高亮插件\"><a href=\"#语法高亮插件\" class=\"headerlink\" title=\"语法高亮插件\"></a>语法高亮插件</h3><p>aklt/plantuml-syntax (vim syntax file for plantuml)</p>\n<h2 id=\"使用\"><a href=\"#使用\" class=\"headerlink\" title=\"使用\"></a>使用</h2><h3 id=\"创建uml文件\"><a href=\"#创建uml文件\" class=\"headerlink\" title=\"创建uml文件\"></a>创建uml文件</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vi test.uml</span><br></pre></td></tr></table></figure>\n<img title=\"历史下载\" src=\"http://p27uwfdhv.bkt.clouddn.com/static/images/plantumlpreviewer.png?imageMogr2/2/w/800\">\n<h3 id=\"预览uml图\"><a href=\"#预览uml图\" class=\"headerlink\" title=\"预览uml图\"></a>预览uml图</h3><p>通过命令打开浏览器预览界面<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">:PlantumlOpen</span><br></pre></td></tr></table></figure></p>\n<p>在vi中执行保存命令<code>:w</code>,预览界面会自动刷新</p>\n","raw":null,"categories":[{"name":"shell","path":"api/categories/shell.json"}],"tags":[]},{"title":"shell命令处理字符串","slug":"shell/shell命令处理字符串","date":"2017-06-23T10:32:45.000Z","updated":"2017-06-24T15:32:41.000Z","comments":true,"path":"api/articles/shell/shell命令处理字符串.json","excerpt":null,"keywords":null,"cover":null,"content":"<link rel=\"stylesheet\" href=\"/owl.css\"><link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><h2 id=\"截取字符串\"><a href=\"#截取字符串\" class=\"headerlink\" title=\"截取字符串\"></a>截取字符串</h2><ol>\n<li><code>%+字符+正则表达式</code> 删除字符及右边内容，从源字符串右边开始匹配<br><code>%</code>  单井号表示一旦匹配成功立即删除<br><code>%%</code> 双井号表示一直等相匹配到最后一个字符时再删除</li>\n<li><code>#+正则表达式+字符</code> 删除字符及左边内容，从源字符串左边开始匹配<br><code>#</code>  单井号表示一旦匹配成功立即删除<br><code>##</code> 双井号表示一直等相匹配到最后一个字符时再删除</li>\n</ol>\n<h2 id=\"实例\"><a href=\"#实例\" class=\"headerlink\" title=\"实例\"></a>实例</h2><p>从line指定的路径中截取两个信息，类别和文件名称<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">line=<span class=\"string\">\"shell/shell命令处理字符串.md\"</span></span><br></pre></td></tr></table></figure></p>\n<ol>\n<li><p>截取文件类别：shell<br>删除最右边的“/shell命令处理字符串.md”</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">categories=<span class=\"string\">\"<span class=\"variable\">$&#123;line%%/*&#125;</span>\"</span>  <span class=\"comment\"># %%/* 表示从右边开始，删除最后（最左边）一个 / 号及右边的字符</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>截取文件名称：shell命令处理字符串<br>先删除最左边的“shell/”,再删除最右边的“.md”</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">titlemd=<span class=\"string\">\"<span class=\"variable\">$&#123;line##*/&#125;</span>\"</span>   <span class=\"comment\"># ##*/: 删除\"/\"左边所有字段即\"shell/\"</span></span><br><span class=\"line\">title=<span class=\"string\">\"<span class=\"variable\">$&#123;titlemd%%\\.*&#125;</span>\"</span> <span class=\"comment\"># 删除.md文件后缀</span></span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n","raw":null,"categories":[{"name":"shell","path":"api/categories/shell.json"},{"name":"语法","path":"api/categories/语法.json"}],"tags":[]},{"title":"小米路由常用操作","slug":"小米路由常用操作","date":"2015-09-25T23:59:16.000Z","updated":"2018-03-28T07:42:14.000Z","comments":true,"path":"api/articles/小米路由常用操作.json","excerpt":null,"keywords":null,"cover":null,"content":"<link rel=\"stylesheet\" href=\"/owl.css\"><link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><h4 id=\"常用命令\"><a href=\"#常用命令\" class=\"headerlink\" title=\"常用命令\"></a>常用命令</h4><ol>\n<li><p>ssh登录</p>\n<pre><code>局域网登录:\nssh [user@]hostname [command]\n 例如：ssh root@192.168.31.1  或  远程登录：ssh root@222.35.145.28 -p 2195\n回车\n输入密码\n\n**修改密码：**\nroot@xiaoqiang:~#passwd   \n回车\n输入新密码\n回车\n再次输入新密码\n</code></pre></li>\n<li><p>远程拷贝数据</p>\n<pre><code>scp Desktop/ar71xx/* root@192.168.31.1:/userdisk/myWorkspace/ar71xx\n</code></pre></li>\n<li><p>每次重启路由获取IP:</p>\n<pre><code>vi /etc/rc.local\nsh /etc/getIP.sh\n</code></pre><p>//启动后，等待20秒，然后，获取当前时间作为文件名称<br>//使用ifconfig 获取路由器的ip信息<br>//使用 | grep 通道，和grep正则来过滤出，wan口的ip所在行<br>// &gt; 使用重定向，将过滤的ip行，写入路由硬盘/userdisk/data/my/ip目录中<br>//通过小米路由手机客户端，找到该txt文件，并下载到手机sd卡中<br>//查看该文件，既有路由重启后的当前IP  </p>\n<a id=\"more\"></a>\n<p> 详见getIP.sh</p>\n<pre><code>#!/bin/sh\nsleep 20\ncurrent_date=`date +%Y_%m_%d`\ncurrent_time=`date +%H_%M_%S`\necho $current_date\necho $current_time\n#local_ip=`ifconfig |grep &apos;[0-9]\\{1,3\\}.*P-t-P&apos;`\nlocal_ip=`ifconfig | grep P-t-P`\necho $local_ip &gt; /userdisk/data/my/ip/$current_date:$current_time.txt\n</code></pre></li>\n<li><p>修改防火墙设置<strong>/etc/config</strong>目录下的<strong>dropbear</strong>和<strong>firewall</strong>  </p>\n<pre><code>cd /etc/config  //把备份文件内容覆盖新文件即可\n1.cat dropbear.bak &gt; dropbear  \n    增加如下内容：\n    config dropbear\n    option PasswordAuth &apos;on&apos;\n    option RootPasswordAuth &apos;on&apos;\n    option Interface &apos;wan&apos;\n    option Port &apos;2195&apos;\n2.保存文件修改后，再重启dropbear服务，一次输入下面两行命令：\n    /etc/init.d/dropbear reload\n    /etc/init.d/dropbear restart\n1.cat firewall.bak &gt; firewall\n    增加如下内容： \n    config rule\n    option name &apos;Allow-wan-ssh&apos;\n    option src &apos;wan&apos;\n    option proto &apos;tcp&apos;\n    option dest_port &apos;2195&apos;\n    option target &apos;ACCEPT&apos;\n2.保存文档的更改后，重启防火墙服务，依次输入以下两条命令：\n    /etc/init.d/firewall reload\n    /etc/init.d/firewall restart\n</code></pre></li>\n</ol>\n<p>5.由于铁通机制，分配的独立iP，并不能被外网访问</p>\n<h4 id=\"ssh登录数据库-转\"><a href=\"#ssh登录数据库-转\" class=\"headerlink\" title=\"ssh登录数据库    转\"></a>ssh登录数据库    <a href=\"http://bbs.xiaomi.cn/thread-10339070-1-1.html\" target=\"_blank\" rel=\"noopener\">转</a></h4><p>先确保能访问<a href=\"http://192.168.31.1:8088/phpinfo.php\" target=\"_blank\" rel=\"noopener\">LLMP搭建的个人网站地址</a>  </p>\n<p>修复教程：  </p>\n<ol>\n<li>登录路由： <code>ssh root@192.168.31.1</code>  mm:admin</li>\n<li>执行命令：<code>/userdisk/data/lamp.sh fix</code>  </li>\n<li><p>再次访问个人网站地址。  <a href=\"http://192.168.31.1:8088/phpinfo.php\" target=\"_blank\" rel=\"noopener\">LLMP搭建的个人网站地址</a> 。 </p>\n<pre><code>1./userdisk/data/lamp.sh  (安装本插件，一键开启llmp，具体安装过程可见前面的安装步骤）       \n2./userdisk/data/lamp.sh a（卸载本插件，恢复安装前，注：卸载本插件时路由器会自动重启一次，自动断网几分钟）\n3./userdisk/data/lamp.sh fix（升级小米路由器固件后，能瞬间恢复自己搭建的网站功能，另外，如果在极特殊的情况的情况下，本功能无效，可使用如下方法恢复自建网站的功能：先尝试重新安装本插件，如果提示不能重复安装，可先卸载本插件，再重新安装本插件，并按说明3对数据库执行修改密码命令，改回原来的密码，原来自己搭建网站就可恢复使用）\n4./userdisk/data/lamp.sh help  (插件用法的帮助信息）\n</code></pre></li>\n</ol>\n<p>登录数据库：<code>ssh mysql@192.168.31.1 -p 2222</code></p>\n<p>正确日志：</p>\n<pre><code>AdmindeMacBook-Air:~ admin$ ssh mysql@192.168.31.1 -p 2222\nThe authenticity of host &apos;[192.168.31.1]:2222 ([192.168.31.1]:2222)&apos; can&apos;t be established.\nRSA key fingerprint is SHA256:bLH9smUb7sD9CZLWCsT6t9YqPy2jciznepkscFNd59M.\nAre you sure you want to continue connecting (yes/no)? yes\nWarning: Permanently added &apos;[192.168.31.1]:2222&apos; (RSA) to the list of known hosts.\nmysql@192.168.31.1&apos;s password:admin\n\nBusyBox v1.19.4 (2015-05-08 18:41:26 CST) built-in shell (ash)\nEnter &apos;help&apos; for a list of built-in commands.\n\n    ~ $\n</code></pre><p>错误日志：<br>需要修改本地的ssh配置。</p>\n<ol>\n<li>vi /Users/admin/.ssh/known_hosts文件</li>\n<li>删除包含[192.168.31.1]:2222的一行内容。</li>\n<li><p>重新登录数据库：ssh mysql@192.168.31.1 -p 2222。  </p>\n<pre><code>AdmindeMacBook-Air:~ admin$ ssh mysql@192.168.31.1 -p 2222\n@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\n@    WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!     @\n@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\nIT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!\nSomeone could be eavesdropping on you right now (man-in-the-middle attack)!\nIt is also possible that a host key has just been changed.\nThe fingerprint for the RSA key sent by the remote host is\nSHA256:bLH9smUb7sD9CZLWCsT6t9YqPy2jciznepkscFNd59M.\nPlease contact your system administrator.\nAdd correct host key in /Users/admin/.ssh/known_hosts to get rid of this message.\nOffending RSA key in /Users/admin/.ssh/known_hosts:10\nRSA host key for [192.168.31.1]:2222 has changed and you have requested strict checking.\nHost key verification failed.\n</code></pre></li>\n</ol>\n<h5 id=\"客户端MySQLWorkbench无法连接LLMP个人网站的MySql数据库\"><a href=\"#客户端MySQLWorkbench无法连接LLMP个人网站的MySql数据库\" class=\"headerlink\" title=\"客户端MySQLWorkbench无法连接LLMP个人网站的MySql数据库\"></a>客户端MySQLWorkbench无法连接LLMP个人网站的MySql数据库</h5>","raw":null,"categories":[{"name":"shell","path":"api/categories/shell.json"},{"name":"路由器","path":"api/categories/路由器.json"}],"tags":[{"name":"小米路由","path":"api/tags/小米路由.json"},{"name":"SSH","path":"api/tags/SSH.json"},{"name":"协议","path":"api/tags/协议.json"}]}]}